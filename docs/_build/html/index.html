<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Change log &mdash; custodian 0.7.2 documentation</title>
    
    <link rel="stylesheet" href="_static/proBlue.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="custodian 0.7.2 documentation" href="#" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-39574369-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">custodian 0.7.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <p>Custodian is a simple, robust and flexible just-in-time (JIT) job management
framework written in Python. Using custodian, you can create wrappers that
perform error checking, job management and error recovery. It has a simple
plugin framework that allows you to develop specific job management workflows
for different applications.</p>
<p>Error recovery is an important aspect of many <em>high-throughput</em> projects that
generate data on a large scale. When you are running on the order of hundreds
of thousands of jobs, even an error rate of 1% would mean thousands of errored
jobs that would be impossible to deal with on a case-by-case basis.</p>
<p>The specific use case for custodian is for long running jobs, with potentially
random errors. For example, there may be a script that takes several days to
run on a server, with a 1% chance of some IO error causing the job to fail.
Using custodian, one can develop a mechanism to gracefully recover from the
error, and restart the job with modified parameters if necessary.</p>
<p>The current version of Custodian also comes with two sub-packages for error
handling for Vienna Ab Initio Simulation Package (VASP), NwChem and QChem
calculations.</p>
<div class="section" id="change-log">
<h1>Change log<a class="headerlink" href="#change-log" title="Permalink to this headline">¶</a></h1>
<div class="section" id="v0-7-2">
<h2>v0.7.2<a class="headerlink" href="#v0-7-2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Improved WalltimeHandler (PBSWalltimeHandler is a subset and is now
deprecated).</li>
<li>New monty required version (&gt;= 0.2.2).</li>
</ol>
</div>
<div class="section" id="v0-7-1">
<h2>v0.7.1<a class="headerlink" href="#v0-7-1" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Much improved qchem error handling (Xiaohui Qu).</li>
<li>New Monty required version (&gt;= 0.2.0).</li>
</ol>
</div>
<div class="section" id="v0-7-0">
<h2>v0.7.0<a class="headerlink" href="#v0-7-0" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a href="#id1"><span class="problematic" id="id2">**</span></a>Backwards incompatible with v0.6.3. Refactoring to move commonly used
Python utility functions to <a class="reference external" href="https://pypi.python.org/pypi/monty">Monty package</a>, which is now a depedency
for custodian.</li>
<li>Custodian now requires pymatgen &gt;= 2.9.0 for VASP, Qchem and Nwchem jobs
and handlers.</li>
<li>converge_kpoints script now has increment mode.</li>
<li>ErrorHandlers now have a new API, where the class variables &#8220;is_monitor&#8221;
and &#8220;is_terminating&#8221; are provided to indicate if a particular handler
runs in the background during a Job and whether a handler should
terminate the job. Some errors may not be critical or may need to wait
for some other event to terminate a job. For example,
a particular error may require a flag to be set to request a job to
terminate gracefully once it finishes its current task. The handler to
set the flag should not terminate the job.</li>
</ol>
<p><a class="reference internal" href="changelog.html"><em>Older versions</em></a></p>
</div>
</div>
<div class="section" id="getting-custodian">
<h1>Getting custodian<a class="headerlink" href="#getting-custodian" title="Permalink to this headline">¶</a></h1>
<div class="section" id="stable-version">
<h2>Stable version<a class="headerlink" href="#stable-version" title="Permalink to this headline">¶</a></h2>
<p>The version at the Python Package Index (PyPI) is always the latest stable
release that will be hopefully, be relatively bug-free. The easiest way to
install custodian on any system is to use easy_install or pip, as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>easy_install custodian
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install custodian
</pre></div>
</div>
<p>Some plugins (e.g., vasp management) require additional setup (please see
<a class="reference external" href="http://pymatgen.org">pymatgen&#8217;s documentation</a>).</p>
</div>
<div class="section" id="developmental-version">
<h2>Developmental version<a class="headerlink" href="#developmental-version" title="Permalink to this headline">¶</a></h2>
<p>The bleeding edge developmental version is at the custodian&#8217;s <a class="reference external" href="https://github.com/materialsproject/custodian">Github repo</a>. The developmental
version is likely to be more buggy, but may contain new features. The
Github version include test files as well for complete unit testing. After
cloning the source, you can type:</p>
<div class="highlight-python"><div class="highlight"><pre>python setup.py install
</pre></div>
</div>
<p>or to install the package in developmental mode:</p>
<div class="highlight-python"><div class="highlight"><pre>python setup.py develop
</pre></div>
</div>
</div>
</div>
<div class="section" id="requirements">
<h1>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h1>
<p>Custodian requires Python 2.7+. There are no other required dependencies.</p>
<div class="section" id="optional-dependencies">
<h2>Optional dependencies<a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Optional libraries that are required if you need certain features:</p>
<ol class="arabic">
<li><p class="first">Python Materials Genomics (<a class="reference external" href="https://pypi.python.org/pypi/pymatgen">pymatgen</a>) 2.8.10+: To use the plugin for
VASP, NwChem and Qchem. Please install using:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install pymatgen
</pre></div>
</div>
<p>For more information, please consult <a class="reference external" href="http://pymatgen.org">pymatgen&#8217;s documentation</a>.</p>
</li>
<li><p class="first">nose - For complete unittesting.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>The main class in the workflow is known as Custodian, which manages a series
of jobs with a list of error handlers. The general workflow for Custodian is
presented in the figure below.</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="_images/Custodian.png"><img alt="Custodian workflow" src="_images/Custodian.png" style="width: 500px;" /></a>
<p class="caption">Overview of the Custodian workflow.</p>
</div>
<p>The Custodian class takes in two general inputs - a <strong>list of Jobs</strong> and
a <strong>list of ErrorHandlers</strong>. <strong>Jobs</strong> should be subclasses of the
<a class="reference internal" href="custodian.html#custodian.custodian.Job" title="custodian.custodian.Job"><tt class="xref py py-class docutils literal"><span class="pre">custodian.custodian.Job</span></tt></a> abstract base class and <strong>ErrorHandlers</strong>
should be subclasses of the <a class="reference internal" href="custodian.html#custodian.custodian.ErrorHandler" title="custodian.custodian.ErrorHandler"><tt class="xref py py-class docutils literal"><span class="pre">custodian.custodian.ErrorHandler</span></tt></a> abstract
base class. To use custodian, you need to implement concrete implementations
of these abstract base classes.</p>
<div class="section" id="simple-example">
<h2>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h2>
<p>An very simple example implementation is given in the custodian_examples.py
script in the scripts directory. We will now go through the example in detail
here.</p>
<p>The ExampleJob has the following code.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ExampleJob</span><span class="p">(</span><span class="n">Job</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This example job simply sums a random sequence of 100 numbers between 0</span>
<span class="sd">    and 1, adds it to an initial value and puts the value in &#39;total&#39;</span>
<span class="sd">    key in params. Note that it subclasses the Job abstract base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jobid</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;initial&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;total&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The initialization of the ExampleJob requires a jobid,</span>
<span class="sd">        something to simply identify a job, and a params argument,</span>
<span class="sd">        which is a mutable dict that enables storage of the results and can</span>
<span class="sd">        be transferred from Job to Handler.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jobid</span> <span class="o">=</span> <span class="n">jobid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The setup sets the initial and total values to zero at the start of</span>
<span class="sd">        a Job.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;initial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Doing the actual run, i.e., generating a random sequence of 100</span>
<span class="sd">        numbers between 0 and 1, summing it and adding it to the inital</span>
<span class="sd">        value to get the total value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;Running job {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobid</span><span class="p">)</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;initial&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&quot;Current total = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;total&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Simply just print a success message.</span>
        <span class="k">print</span> <span class="s">&quot;Success for job {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A name for the job.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">&quot;ExampleJob{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobid</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All Jobs must implement a to_dict property that returns a JSON</span>
<span class="sd">        serializable dict to enable Custodian to log the job information in</span>
<span class="sd">        a json file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;jobid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobid</span><span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similarly, all Jobs must implement a from_dict static method</span>
<span class="sd">        that takes in a dict of the form returned by to_dict and returns a</span>
<span class="sd">        actual Job.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ExampleJob</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&quot;jobid&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The ExampleJob simply sums a random sequence of 100 numbers between 0 and
1, adds it to an initial value and puts the value in &#8216;total&#8217; variable. The
ExampleJob subclasses the Job abstract base class, and implements the necessary
API comprising of just three key methods: <strong>setup(), run(),
and postprocess()</strong>.</p>
<p>Let us now define an ErrorHandler that will check if the total value is &gt;= 50,
and if it is not, it will increment the initial value by 1 and rerun the
ExampleJob again.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ExampleHandler</span><span class="p">(</span><span class="n">ErrorHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This example error handler checks if the value of total is &gt;= 50. If it</span>
<span class="sd">    is not, the handler increments the initial value and rerun the</span>
<span class="sd">    ExampleJob until a total &gt;= 50 is obtained.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The initialization of the ExampleHandler takes in the same params</span>
<span class="sd">        argument, which should contain the results from the ExampleJob.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The check() step should return a boolean indicating if there are</span>
<span class="sd">        errors. In this case, we define an error to be a situation where the</span>
<span class="sd">        total is less than 50.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;total&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span>

    <span class="k">def</span> <span class="nf">correct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The correct() step should fix any errors and return a dict</span>
<span class="sd">        summarizing the actions taken. In this case, we increment the initial</span>
<span class="sd">        value by 1 in an attempt to increase the total.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;initial&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">print</span> <span class="s">&quot;Total &lt; 50. Incrementing initial to {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&quot;initial&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;errors&quot;</span><span class="p">:</span> <span class="s">&quot;total &lt; 50&quot;</span><span class="p">,</span> <span class="s">&quot;actions&quot;</span><span class="p">:</span> <span class="s">&quot;increment by 1&quot;</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This property indicates whether this handler is a monitor, i.e.,</span>
<span class="sd">        whether it turns in the background as the run is taking place and</span>
<span class="sd">        correcting errors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to Jobs, ErrorHandlers should have a to_dict property that</span>
<span class="sd">        returns a JSON-serializable dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to Jobs, ErrorHandlers should have a from_dict static property</span>
<span class="sd">        that returns the Example Handler from a JSON-serializable dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ExampleHandler</span><span class="p">()</span>
</pre></div>
</div>
<p>As you can see above, the ExampleHandler subclasses the ErrorHandler abstract
base class, and implements the necessary API comprising of just two key
methods: <strong>check() and correct()</strong>.</p>
<p>The transfer of information between the Job and ErrorHandler is done using
the params argument in this example, which is not ideal but is sufficiently
for demonstrating the Custodian API. In real world usage,
a more common transfer of information may involve the Job writing the output
to a file, and the ErrorHandler checking the contents of those files to
detect error situations.</p>
<p>To run the job, one simply needs to supply a list of ExampleJobs and
ErrorHandlers to a Custodian.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">njobs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;initial&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;total&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Custodian</span><span class="p">([</span><span class="n">ExampleHandler</span><span class="p">(</span><span class="n">params</span><span class="p">)],</span>
              <span class="p">[</span><span class="n">ExampleJob</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">njobs</span><span class="p">)],</span>
              <span class="n">max_errors</span><span class="o">=</span><span class="n">njobs</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>If you run custodian_example.py in the scripts directory, you will noticed that
a <strong>custodian.json</strong> file was generated, which summarizes the jobs that have
been run and any corrections performed.</p>
</div>
<div class="section" id="practical-example-electronic-structure-calculations">
<h2>Practical example: Electronic structure calculations<a class="headerlink" href="#practical-example-electronic-structure-calculations" title="Permalink to this headline">¶</a></h2>
<p>A practical example where the Custodian framework is particularly useful is
in the area of electronic structure calculations. Electronic structure
calculations tend to be long running and often terminates due to errors,
random or otherwise. Such errors become a major issue in projects that
performs such calculations in high throughput, such as the <a class="reference external" href="https://www.materialsproject.org">Materials
Project</a>.</p>
<p>The Custodian package comes with a fairly comprehensive plugin to deal
with jobs (<a class="reference internal" href="custodian.vasp.html#module-custodian.vasp.jobs" title="custodian.vasp.jobs"><tt class="xref py py-mod docutils literal"><span class="pre">custodian.vasp.jobs</span></tt></a>) and errors
(<a class="reference internal" href="custodian.vasp.html#module-custodian.vasp.handlers" title="custodian.vasp.handlers"><tt class="xref py py-mod docutils literal"><span class="pre">custodian.vasp.handlers</span></tt></a>) in electronic structure calculations based
on the Vienna Ab Initio Simulation Package (VASP). To do this,
Custodian uses the Python Materials Genomics (<a class="reference external" href="https://pypi.python.org/pypi/pymatgen">pymatgen</a>) package to
perform analysis and io from VASP input and output files.</p>
<p>A simple example of a script using Custodian to run a two-relaxation VASP job
is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">custodian.custodian</span> <span class="kn">import</span> <span class="n">Custodian</span>
<span class="kn">from</span> <span class="nn">custodian.vasp.handlers</span> <span class="kn">import</span> <span class="n">VaspErrorHandler</span><span class="p">,</span> \
    <span class="n">UnconvergedErrorHandler</span><span class="p">,</span> <span class="n">PoscarErrorHandler</span><span class="p">,</span> <span class="n">DentetErrorHandler</span>
<span class="kn">from</span> <span class="nn">custodian.vasp.jobs</span> <span class="kn">import</span> <span class="n">VaspJob</span>

<span class="n">handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">VaspErrorHandler</span><span class="p">(),</span> <span class="n">UnconvergedErrorHandler</span><span class="p">(),</span>
            <span class="n">PoscarErrorHandler</span><span class="p">(),</span> <span class="n">DentetErrorHandler</span><span class="p">()]</span>
<span class="n">jobs</span> <span class="o">=</span> <span class="n">VaspJob</span><span class="o">.</span><span class="n">double_relaxation_run</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Custodian</span><span class="p">(</span><span class="n">handlers</span><span class="p">,</span> <span class="n">jobs</span><span class="p">,</span> <span class="n">max_errors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The above will gracefully deal with many VASP errors encountered during
relaxation. For example, it will correct ISMEAR to 0 if there are
insufficient KPOINTS to use ISMEAR = -5.</p>
<p>Using custodian, you can even setup potentially indefinite jobs,
e.g. kpoints convergence jobs with a target energy convergence. Please see the
converge_kpoints script in the scripts for an example.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.4.3: </span>A new package for dealing with NwChem calculations has been added.
NwChem is an open-source code for performing computational chemistry
calculations.</p>
</div>
</div>
</div>
<div class="section" id="api-reference-docs">
<h1>API/Reference Docs<a class="headerlink" href="#api-reference-docs" title="Permalink to this headline">¶</a></h1>
<p>The API docs are generated using Sphinx auto-doc and outlines the purpose of all
modules and classes, and the expected argument and returned objects for most
methods. They are available at the link below.</p>
<p><a class="reference internal" href="modules.html"><em>custodian API docs</em></a></p>
</div>
<div class="section" id="how-to-cite-custodian">
<h1>How to cite custodian<a class="headerlink" href="#how-to-cite-custodian" title="Permalink to this headline">¶</a></h1>
<p>If you use custodian in your research, especially the VASP component, please
consider citing the following work:</p>
<blockquote>
<div>Shyue Ping Ong, William Davidson Richards, Anubhav Jain, Geoffroy Hautier,
Michael Kocher, Shreyas Cholia, Dan Gunter, Vincent Chevrier, Kristin A.
Persson, Gerbrand Ceder. <em>Python Materials Genomics (pymatgen) : A Robust,
Open-Source Python Library for Materials Analysis.</em> Computational
Materials Science, 2013, 68, 314–319. <a class="reference external" href="http://dx.doi.org/10.1016/j.commatsci.2012.10.028">doi:10.1016/j.commatsci.2012.10.028</a></div></blockquote>
</div>
<div class="section" id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h1>
<p>Custodian is released under the MIT License. The terms of the license are as
follows:</p>
<div class="highlight-python"><div class="highlight"><pre>The MIT License (MIT)
Copyright (c) 2011-2012 MIT &amp; LBNL

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the &quot;Software&quot;)
, to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Change log</a><ul>
<li><a class="reference internal" href="#v0-7-2">v0.7.2</a></li>
<li><a class="reference internal" href="#v0-7-1">v0.7.1</a></li>
<li><a class="reference internal" href="#v0-7-0">v0.7.0</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-custodian">Getting custodian</a><ul>
<li><a class="reference internal" href="#stable-version">Stable version</a></li>
<li><a class="reference internal" href="#developmental-version">Developmental version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#requirements">Requirements</a><ul>
<li><a class="reference internal" href="#optional-dependencies">Optional dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#simple-example">Simple example</a></li>
<li><a class="reference internal" href="#practical-example-electronic-structure-calculations">Practical example: Electronic structure calculations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-reference-docs">API/Reference Docs</a></li>
<li><a class="reference internal" href="#how-to-cite-custodian">How to cite custodian</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="#">custodian 0.7.2 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, Shyue Ping Ong.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>