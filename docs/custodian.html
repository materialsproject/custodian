
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>custodian package &#8212; custodian 2021.2.8 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_flask.css" type= "text/css" rel="stylesheet" />
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-39574369-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">custodian 2021.2.8 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">custodian package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="custodian-package">
<h1>custodian package<a class="headerlink" href="#custodian-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="custodian.ansible.html">custodian.ansible package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.ansible.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.ansible.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.ansible.html#module-custodian.ansible.actions">custodian.ansible.actions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.ansible.html#module-custodian.ansible.interpreter">custodian.ansible.interpreter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.ansible.html#module-custodian.ansible">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.cli.html">custodian.cli package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#custodian-cli-converge-geometry-module">custodian.cli.converge_geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#custodian-cli-converge-kpoints-module">custodian.cli.converge_kpoints module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#module-custodian.cli.cstdn">custodian.cli.cstdn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#custodian-cli-run-nwchem-module">custodian.cli.run_nwchem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#custodian-cli-run-vasp-module">custodian.cli.run_vasp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.cli.html#module-custodian.cli">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.feff.html">custodian.feff package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#custodian-feff-handlers-module">custodian.feff.handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#custodian-feff-interpreter-module">custodian.feff.interpreter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#module-custodian.feff.jobs">custodian.feff.jobs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.feff.html#module-custodian.feff">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.lobster.html">custodian.lobster package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.lobster.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.lobster.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.lobster.html#custodian-lobster-handlers-module">custodian.lobster.handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.lobster.html#module-custodian.lobster.jobs">custodian.lobster.jobs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.lobster.html#module-custodian.lobster">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.nwchem.html">custodian.nwchem package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.nwchem.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.nwchem.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.nwchem.html#custodian-nwchem-handlers-module">custodian.nwchem.handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.nwchem.html#module-custodian.nwchem.jobs">custodian.nwchem.jobs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.nwchem.html#module-custodian.nwchem">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.qchem.html">custodian.qchem package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.qchem.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.qchem.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.qchem.html#custodian-qchem-handlers-module">custodian.qchem.handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.qchem.html#custodian-qchem-jobs-module">custodian.qchem.jobs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.qchem.html#module-custodian.qchem">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custodian.vasp.html">custodian.vasp package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#subpackages">Subpackages</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#custodian-vasp-handlers-module">custodian.vasp.handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#custodian-vasp-interpreter-module">custodian.vasp.interpreter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#custodian-vasp-jobs-module">custodian.vasp.jobs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#custodian-vasp-validators-module">custodian.vasp.validators module</a></li>
<li class="toctree-l2"><a class="reference internal" href="custodian.vasp.html#module-custodian.vasp">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-custodian.custodian">
<span id="custodian-custodian-module"></span><h2>custodian.custodian module<a class="headerlink" href="#module-custodian.custodian" title="Permalink to this headline">¶</a></h2>
<p>This module implements the main Custodian class, which manages a list of jobs
given a set of error handlers, the abstract base classes for the
ErrorHandlers and Jobs.</p>
<dl class="py class">
<dt id="custodian.custodian.Custodian">
<em class="property">class </em><code class="sig-name descname">Custodian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handlers</span></em>, <em class="sig-param"><span class="n">jobs</span></em>, <em class="sig-param"><span class="n">validators</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_errors_per_job</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_errors</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">polling_time_step</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">monitor_freq</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">skip_over_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scratch_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">gzipped_output</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">checkpoint</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">terminate_func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">terminate_on_nonzero_returncode</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Custodian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Custodian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Custodian class is the manager for a list of jobs given a list of
error handlers. The way it works is as follows:</p>
<ol class="arabic simple">
<li><p>Let’s say you have defined a list of jobs as [job1, job2, job3, …] and
you have defined a list of possible error handlers as [err1, err2, …]</p></li>
<li><p>Custodian will run the jobs in the order of job1, job2, … During each
job, custodian will monitor for errors using the handlers that have
is_monitor == True. If an error is detected, corrective measures are
taken and the particular job is rerun.</p></li>
<li><p>At the end of each individual job, Custodian will run through the list
error handlers that have is_monitor == False. If an error is detected,
corrective measures are taken and the particular job is rerun.</p></li>
</ol>
<p>Initializes a Custodian from a list of jobs and error handler.s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handlers</strong> (<em>[</em><a class="reference internal" href="#custodian.custodian.ErrorHandler" title="custodian.custodian.ErrorHandler"><em>ErrorHandler</em></a><em>]</em>) – Error handlers. In order of priority of
fixing.</p></li>
<li><p><strong>jobs</strong> (<em>[</em><a class="reference internal" href="#custodian.custodian.Job" title="custodian.custodian.Job"><em>Job</em></a><em>]</em>) – Sequence of Jobs to be run. Note that this can be
any sequence or even a generator yielding jobs.</p></li>
<li><p><strong>validators</strong> (<em>[</em><a class="reference internal" href="#custodian.custodian.Validator" title="custodian.custodian.Validator"><em>Validator</em></a><em>]</em>) – Validators to ensure job success</p></li>
<li><p><strong>max_errors_per_job</strong> (<em>int</em>) – Maximum number of errors per job allowed
before exiting. Defaults to None, which means it is set to be
equal to max_errors..</p></li>
<li><p><strong>max_errors</strong> (<em>int</em>) – Maximum number of total errors allowed before
exiting. Defaults to 1.</p></li>
<li><p><strong>polling_time_step</strong> (<em>int</em>) – The length of time in seconds between
steps in which a job is checked for completion. Defaults to
10 secs.</p></li>
<li><p><strong>monitor_freq</strong> (<em>int</em>) – The number of polling steps before monitoring
occurs. For example, if you have a polling_time_step of 10
seconds and a monitor_freq of 30, this means that Custodian
uses the monitors to check for errors every 30 x 10 = 300
seconds, i.e., 5 minutes.</p></li>
<li><p><strong>skip_over_errors</strong> (<em>bool</em>) – If set to True, custodian will skip over
error handlers that failed (raised an Exception of some sort).
Otherwise, custodian will simply exit on unrecoverable errors.
The former will lead to potentially more robust performance,
but may make it difficult to improve handlers. The latter
will allow one to catch potentially bad error handler
implementations. Defaults to False.</p></li>
<li><p><strong>scratch_dir</strong> (<em>str</em>) – If this is set, any files in the current
directory are copied to a temporary directory in a scratch
space first before any jobs are performed, and moved back to
the current directory upon completion of all jobs. This is
useful in some setups where a scratch partition has much
faster IO. To use this, set scratch_dir=root of directory you
want to use for runs. There is no need to provide unique
directory names; we will use python’s tempfile creation
mechanisms. A symbolic link is created during the course of
the run in the working directory called “scratch_link” as
users may want to sometimes check the output during the
course of a run. If this is None (the default), the run is
performed in the current working directory.</p></li>
<li><p><strong>gzipped_output</strong> (<em>bool</em>) – Whether to gzip the final output to save
space. Defaults to False.</p></li>
<li><p><strong>checkpoint</strong> (<em>bool</em>) – Whether to checkpoint after each successful Job.
Checkpoints are stored as custodian.chk.#.tar.gz files. Defaults
to False.</p></li>
<li><p><strong>terminate_func</strong> (<em>callable</em>) – A function to be called to terminate a
running job. If None, the default is to call Popen.terminate.</p></li>
<li><p><strong>terminate_on_nonzero_returncode</strong> (<em>bool</em>) – If True, a non-zero return
code on any Job will result in a termination. Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="custodian.custodian.Custodian.LOG_FILE">
<code class="sig-name descname">LOG_FILE</code><em class="property"> = 'custodian.json'</em><a class="headerlink" href="#custodian.custodian.Custodian.LOG_FILE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Custodian.from_spec">
<em class="property">classmethod </em><code class="sig-name descname">from_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Custodian.from_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Custodian.from_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a Custodian instance where the jobs are specified from a
structure and a spec dict. This allows simple
custom job sequences to be constructed quickly via a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spec</strong> (<em>dict</em>) – <p>A dict specifying job. A sample of the dict in
YAML format for the usual MP workflow is given as follows</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>`
jobs:
- jb: custodian.vasp.jobs.VaspJob</p>
<blockquote>
<div><dl class="simple">
<dt>params:</dt><dd><p>final: False
suffix: .relax1</p>
</dd>
</dl>
</div></blockquote>
<ul>
<li><p>jb: custodian.vasp.jobs.VaspJob
params:</p>
<blockquote>
<div><p>final: True
suffix: .relax2
settings_override: {“file”: “CONTCAR”, “action”: {“_file_copy”: {“dest”: “POSCAR”}}</p>
</div></blockquote>
</li>
</ul>
<dl class="simple">
<dt>jobs_common_params:</dt><dd><p>vasp_cmd: /opt/vasp</p>
</dd>
</dl>
<p>handlers:
- hdlr: custodian.vasp.handlers.VaspErrorHandler
- hdlr: custodian.vasp.handlers.AliasingErrorHandler
- hdlr: custodian.vasp.handlers.MeshSymmetryHandler
validators:
- vldr: custodian.vasp.validators.VasprunXMLValidator
custodian_params:</p>
<blockquote>
<div><p>scratch_dir: /tmp</p>
</div></blockquote>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a></p>
<p>The <cite>jobs</cite> key is a list of jobs. Each job is
specified via “job”: &lt;explicit path&gt;, and all parameters are
specified via <cite>params</cite> which is a dict.</p>
<p><cite>common_params</cite> specify a common set of parameters that are
passed to all jobs, e.g., vasp_cmd.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Custodian instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Custodian.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Custodian.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Custodian.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs all jobs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All errors encountered as a list of list.
[[error_dicts for job 1], [error_dicts for job 2], ….]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#custodian.custodian.ValidationError" title="custodian.custodian.ValidationError"><strong>ValidationError</strong></a> – if a job fails validation</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.ReturnCodeError" title="custodian.custodian.ReturnCodeError"><strong>ReturnCodeError</strong></a> – if the process has a return code different from 0</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.NonRecoverableError" title="custodian.custodian.NonRecoverableError"><strong>NonRecoverableError</strong></a> – if an unrecoverable occurs</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsPerJobError" title="custodian.custodian.MaxCorrectionsPerJobError"><strong>MaxCorrectionsPerJobError</strong></a> – if max_errors_per_job is reached</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsError" title="custodian.custodian.MaxCorrectionsError"><strong>MaxCorrectionsError</strong></a> – if max_errors is reached</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsPerHandlerError" title="custodian.custodian.MaxCorrectionsPerHandlerError"><strong>MaxCorrectionsPerHandlerError</strong></a> – if max_errors_per_handler is reached</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Custodian.run_interrupted">
<code class="sig-name descname">run_interrupted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Custodian.run_interrupted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Custodian.run_interrupted" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs custodian in a interuppted mode, which sets up and
validates jobs but doesn’t run the executable</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of remaining jobs</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#custodian.custodian.ValidationError" title="custodian.custodian.ValidationError"><strong>ValidationError</strong></a> – if a job fails validation</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.ReturnCodeError" title="custodian.custodian.ReturnCodeError"><strong>ReturnCodeError</strong></a> – if the process has a return code different from 0</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.NonRecoverableError" title="custodian.custodian.NonRecoverableError"><strong>NonRecoverableError</strong></a> – if an unrecoverable occurs</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsPerJobError" title="custodian.custodian.MaxCorrectionsPerJobError"><strong>MaxCorrectionsPerJobError</strong></a> – if max_errors_per_job is reached</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsError" title="custodian.custodian.MaxCorrectionsError"><strong>MaxCorrectionsError</strong></a> – if max_errors is reached</p></li>
<li><p><a class="reference internal" href="#custodian.custodian.MaxCorrectionsPerHandlerError" title="custodian.custodian.MaxCorrectionsPerHandlerError"><strong>MaxCorrectionsPerHandlerError</strong></a> – if max_errors_per_handler is reached</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.CustodianError">
<em class="property">exception </em><code class="sig-name descname">CustodianError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#CustodianError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.CustodianError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
<p>Exception class for Custodian errors.</p>
<p>Initializes the error with a message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="custodian.custodian.ErrorHandler">
<em class="property">class </em><code class="sig-name descname">ErrorHandler</code><a class="reference internal" href="_modules/custodian/custodian.html#ErrorHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.ErrorHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Abstract base class defining the interface for an ErrorHandler.</p>
<dl class="py method">
<dt id="custodian.custodian.ErrorHandler.check">
<em class="property">abstract </em><code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#ErrorHandler.check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.ErrorHandler.check" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called during the job (for monitors) or at the end of
the job to check for errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(bool) Indicating if errors are detected.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.ErrorHandler.correct">
<em class="property">abstract </em><code class="sig-name descname">correct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#ErrorHandler.correct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.ErrorHandler.correct" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the end of a job when an error is detected.
It should perform any corrective measures relating to the detected
error.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(dict) JSON serializable dict that describes the errors and
actions taken. E.g.
{“errors”: list_of_errors, “actions”: list_of_actions_taken}.
If this is an unfixable error, actions should be set to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="custodian.custodian.ErrorHandler.is_monitor">
<code class="sig-name descname">is_monitor</code><em class="property"> = False</em><a class="headerlink" href="#custodian.custodian.ErrorHandler.is_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>This class property indicates whether the error handler is a monitor,
i.e., a handler that monitors a job as it is running. If a
monitor-type handler notices an error, the job will be sent a
termination signal, the error is then corrected,
and then the job is restarted. This is useful for catching errors
that occur early in the run but do not cause immediate failure.</p>
</dd></dl>

<dl class="py attribute">
<dt id="custodian.custodian.ErrorHandler.is_terminating">
<code class="sig-name descname">is_terminating</code><em class="property"> = True</em><a class="headerlink" href="#custodian.custodian.ErrorHandler.is_terminating" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this handler terminates a job upon error detection. By
default, this is True, which means that the current Job will be
terminated upon error detection, corrections applied,
and restarted. In some instances, some errors may not need the job to be
terminated or may need to wait for some other event to terminate a job.
For example, a particular error may require a flag to be set to request
a job to terminate gracefully once it finishes its current task. The
handler to set the flag should be classified as is_terminating = False to
not terminate the job.</p>
</dd></dl>

<dl class="py attribute">
<dt id="custodian.custodian.ErrorHandler.max_num_corrections">
<code class="sig-name descname">max_num_corrections</code><em class="property"> = None</em><a class="headerlink" href="#custodian.custodian.ErrorHandler.max_num_corrections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="custodian.custodian.ErrorHandler.n_applied_corrections">
<em class="property">property </em><code class="sig-name descname">n_applied_corrections</code><a class="headerlink" href="#custodian.custodian.ErrorHandler.n_applied_corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times the handler has given a correction and this
has been applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of corrections applied.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="custodian.custodian.ErrorHandler.raise_on_max">
<code class="sig-name descname">raise_on_max</code><em class="property"> = False</em><a class="headerlink" href="#custodian.custodian.ErrorHandler.raise_on_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether corrections from this specific handler should be applied only a
fixed maximum number of times on a single job (i.e. the counter is reset
at the beginning of each job). If the maximum number is reached the code
will either raise a MaxCorrectionsPerHandlerError (raise_on_max==True) or stops
considering the correction (raise_on_max==False). If max_num_corrections
is None this option is not considered. These options can be overridden
as class attributes of the subclass or as customizable options setting
an instance attribute from __init__.</p>
</dd></dl>

<dl class="py attribute">
<dt id="custodian.custodian.ErrorHandler.raises_runtime_error">
<code class="sig-name descname">raises_runtime_error</code><em class="property"> = True</em><a class="headerlink" href="#custodian.custodian.ErrorHandler.raises_runtime_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this handler causes custodian to raise a runtime error if it cannot
handle the error (i.e. if correct returns a dict with “actions”:None, or
“actions”:[])</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="custodian.custodian.Job">
<em class="property">class </em><code class="sig-name descname">Job</code><a class="reference internal" href="_modules/custodian/custodian.html#Job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Job" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Abstract base class defining the interface for a Job.</p>
<dl class="py method">
<dt id="custodian.custodian.Job.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#custodian.custodian.Job.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A nice string name for the job.</p>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Job.postprocess">
<em class="property">abstract </em><code class="sig-name descname">postprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Job.postprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Job.postprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the end of a job, <em>after</em> error detection.
This allows post-processing, such as cleanup, analysis of results,
etc.</p>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Job.run">
<em class="property">abstract </em><code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Job.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Job.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This method perform the actual work for the job. If parallel error
checking (monitoring) is desired, this must return a Popen process.</p>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Job.setup">
<em class="property">abstract </em><code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Job.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Job.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is run before the start of a job. Allows for some
pre-processing.</p>
</dd></dl>

<dl class="py method">
<dt id="custodian.custodian.Job.terminate">
<code class="sig-name descname">terminate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Job.terminate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Job.terminate" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement termination function.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.MaxCorrectionsError">
<em class="property">exception </em><code class="sig-name descname">MaxCorrectionsError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span></em>, <em class="sig-param"><span class="n">max_errors</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#MaxCorrectionsError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.MaxCorrectionsError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when the maximum allowed number of errors is reached</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
<li><p><strong>max_errors</strong> (<em>int</em>) – the number of errors reached</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.MaxCorrectionsPerHandlerError">
<em class="property">exception </em><code class="sig-name descname">MaxCorrectionsPerHandlerError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span></em>, <em class="sig-param"><span class="n">max_errors_per_handler</span></em>, <em class="sig-param"><span class="n">handler</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#MaxCorrectionsPerHandlerError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.MaxCorrectionsPerHandlerError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when the maximum allowed number of errors per handler is reached</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
<li><p><strong>max_errors_per_handler</strong> (<em>int</em>) – the number of errors per job reached</p></li>
<li><p><strong>handler</strong> (<em>Handler</em>) – the handler that caused the exception</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.MaxCorrectionsPerJobError">
<em class="property">exception </em><code class="sig-name descname">MaxCorrectionsPerJobError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span></em>, <em class="sig-param"><span class="n">max_errors_per_job</span></em>, <em class="sig-param"><span class="n">job</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#MaxCorrectionsPerJobError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.MaxCorrectionsPerJobError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when the maximum allowed number of errors per job is reached</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
<li><p><strong>max_errors_per_job</strong> (<em>int</em>) – the number of errors per job reached</p></li>
<li><p><strong>job</strong> (<a class="reference internal" href="#custodian.custodian.Job" title="custodian.custodian.Job"><em>Job</em></a>) – the job that was stopped</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.NonRecoverableError">
<em class="property">exception </em><code class="sig-name descname">NonRecoverableError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span></em>, <em class="sig-param"><span class="n">handler</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#NonRecoverableError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.NonRecoverableError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when a handler found an error but could not fix it</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
<li><p><strong>handler</strong> (<em>Handler</em>) – Handler that caused the exception.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.ReturnCodeError">
<em class="property">exception </em><code class="sig-name descname">ReturnCodeError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#ReturnCodeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.ReturnCodeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when the process gave non zero return code</p>
<p>Initializes the error with a message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="custodian.custodian.ValidationError">
<em class="property">exception </em><code class="sig-name descname">ValidationError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">raises</span></em>, <em class="sig-param"><span class="n">validator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#ValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.ValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#custodian.custodian.CustodianError" title="custodian.custodian.CustodianError"><code class="xref py py-class docutils literal notranslate"><span class="pre">custodian.custodian.CustodianError</span></code></a></p>
<p>Error raised when a validator does not pass the check</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – Message passed to Exception</p></li>
<li><p><strong>raises</strong> (<em>bool</em>) – Whether this should be raised outside custodian</p></li>
<li><p><strong>validator</strong> (<a class="reference internal" href="#custodian.custodian.Validator" title="custodian.custodian.Validator"><em>Validator</em></a>) – Validator that caused the exception.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="custodian.custodian.Validator">
<em class="property">class </em><code class="sig-name descname">Validator</code><a class="reference internal" href="_modules/custodian/custodian.html#Validator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Abstract base class defining the interface for a Validator. A Validator
differs from an ErrorHandler in that it does not correct a run and is run
only at the end of a Job. If errors are detected by a Validator, a run is
immediately terminated.</p>
<dl class="py method">
<dt id="custodian.custodian.Validator.check">
<em class="property">abstract </em><code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/custodian.html#Validator.check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.custodian.Validator.check" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called at the end of a job.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(bool) Indicating if errors are detected.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-custodian.utils">
<span id="custodian-utils-module"></span><h2>custodian.utils module<a class="headerlink" href="#module-custodian.utils" title="Permalink to this headline">¶</a></h2>
<p>Utility function and classes.</p>
<dl class="py function">
<dt id="custodian.utils.backup">
<code class="sig-name descname">backup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filenames</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">'error'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/utils.html#backup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.utils.backup" title="Permalink to this definition">¶</a></dt>
<dd><p>Backup files to a tar.gz file. Used, for example, in backing up the
files of an errored run before performing corrections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<em>[</em><em>str</em><em>]</em>) – List of files to backup. Supports wildcards, e.g.,
<em>.</em>.</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – prefix to the files. Defaults to error, which means a
series of error.1.tar.gz, error.2.tar.gz, … will be generated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="custodian.utils.get_execution_host_info">
<code class="sig-name descname">get_execution_host_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/custodian/utils.html#get_execution_host_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#custodian.utils.get_execution_host_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to return a tuple describing the execution host.
Doesn’t work for all queueing systems</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(HOSTNAME, CLUSTER_NAME)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-custodian">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-custodian" title="Permalink to this headline">¶</a></h2>
<p>Custodian is a simple, robust and flexible just-in-time (JIT) job management
framework written in Python.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">custodian package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-custodian.custodian">custodian.custodian module</a></li>
<li><a class="reference internal" href="#module-custodian.utils">custodian.utils module</a></li>
<li><a class="reference internal" href="#module-custodian">Module contents</a></li>
</ul>
</li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/custodian.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
      &copy; Copyright 2013, Shyue Ping Ong, William Davidson Richards, Stephen Dacek, Xiaohui Qu, Matthew Horton, Samuel M. Blau.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>